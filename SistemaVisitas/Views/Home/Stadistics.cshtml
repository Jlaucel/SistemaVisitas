@using SistemaVisitas.Models
@model ReporteVisitaModelList
@{
    ViewBag.Title = "Stadistics";
}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

<style >

    .tableFixHead {
        overflow: auto;
        height: 700px;
        width: auto;
    }

        .tableFixHead thead th {
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .tableFixHead tbody th {
            position: sticky;
            left: 0;
        }
</style>


<div class="row">
    <h2> Reporte General </h2>
    <div class="table-responsive table--no-card m-b-40 ">
        <table id="example" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    @foreach (System.Data.DataColumn col in ViewBag.ReporteGeneral.Columns)
                    {

                        <th>@col.Caption </th>


                    }


                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow row in ViewBag.ReporteGeneral.Rows)
                {

                    <tr>
                        @foreach (var cell in row.ItemArray)
                        {
                            <td>@cell.ToString() </td>
                        }
                    </tr>
                }
            </tbody>

        </table>
        </div> 
    </div>

<button id="BTN_UPSA">PRESIONA </button>

   









     

       
        



    <script>



        $(document).ready(function () {

            $('#example').DataTable();
            var d = new Date();

            var month = d.getMonth() + 1;
            var day = d.getDate();

            var output = d.getFullYear() + '/' +
                (month < 10 ? '0' : '') + month + '/' +
                (day < 10 ? '0' : '') + day;



            $("#BTN_UPSA").click(function () {
                $("#example").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "UPSA",
                    filename: "UPSA_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });

            $("#BTN_UPSB").click(function () {
                $("#UPSB_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "UPSB",
                    filename: "UPSB_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });

            $("#BTN_AIR20").click(function () {
                $("#AIR20_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "AIRE 20 TONELADAS",
                    filename: "AIRE_20TON_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });


            $("#BTN_AIR5").click(function () {
                $("#AIR5_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "AIRE 5 TONELADAS",
                    filename: "AIRE_5TON_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });


            $("#BTN_PDUA").click(function () {
                $("#PDUA_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "PDUA ",
                    filename: "PDUA_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });

            $("#BTN_PDUB").click(function () {
                $("#PDUB_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "PDUB",
                    filename: "PDUB_REPORTE_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });

            $("#BTN_ReporteGeneral").click(function () {
                $("#ReporteGeneral_TABLE").table2excel({
                    // exclude CSS class
                    exclude: ".noExl",
                    name: "ReporteGeneral",
                    filename: "ReporteGeneral_" + output, //do not include extension
                    fileext: ".xlsx" // file extension
                });
            });


        });



    </script>
